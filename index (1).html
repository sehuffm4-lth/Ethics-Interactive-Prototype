<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Software Engineering Ethics Interactive</title>
    <meta name="description" content="Interactive ethics case studies" />
    <!-- No build tools needed. We load React from a CDN and use Babel in the browser. -->
    <style>
      :root{ --bg:#f5f6f8; --card:#fff; --text:#1f2937; --muted:#4b5563; --border:#e5e7eb; --brand:#4f46e5; --brand-600:#4338ca; }
      *{box-sizing:border-box}
      html,body,#root{height:100%}
      body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;color:var(--text);background:var(--bg)}
      .container{max-width:960px;margin:0 auto;padding:24px}
      .text-center{text-align:center}
      .site-header{position:sticky;top:0;z-index:10;background:rgba(255,255,255,.9);backdrop-filter:saturate(180%) blur(10px);border-bottom:1px solid var(--border)}
      .header-inner{max-width:960px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;padding:10px 16px}
      .brand{display:flex;align-items:center;gap:12px}
      .brand-badge{width:32px;height:32px;border-radius:10px;background:var(--brand)}
      .brand-title{font-weight:800}
      .brand-sub{font-size:12px;color:var(--muted)}
      .header-actions{display:none;gap:8px}
      .header-progress{max-width:960px;margin:0 auto;padding:0 16px 10px}
      @media (min-width:640px){.header-actions{display:flex}}
      .progress-wrap{padding:8px 0}
      .progress{height:8px;background:#e5e7eb;border-radius:999px;overflow:hidden}
      .progress-bar{height:8px;background:var(--brand);transition:width .2s ease}
      .progress-text{text-align:right;font-size:12px;color:#6b7280;margin-top:4px}
      .card{background:var(--card);box-shadow:0 1px 2px rgba(0,0,0,.06);border-radius:16px;padding:24px}
      .h1{font-size:clamp(28px,3.5vw,36px);font-weight:900;margin:0}
      .h2{font-size:clamp(22px,3vw,28px);font-weight:800;margin:0}
      .h3{font-size:18px;font-weight:700;margin:0}
      .lead{font-size:18px;color:var(--muted);margin-top:12px}
      .prose{margin-top:12px;line-height:1.6;color:#374151}
      .prose p{margin:0 0 10px 0}
      .muted{color:var(--muted);margin-top:8px}
      .pill{display:inline-block;padding:4px 10px;border-radius:999px;background:#eef2ff;color:#3730a3;border:1px solid #e0e7ff;font-size:12px}
      .pill-row{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;margin-top:16px}
      .btn{display:inline-flex;align-items:center;justify-content:center;padding:10px 14px;border-radius:12px;font-weight:700;border:1px solid transparent;cursor:pointer;transition:filter .15s ease, background .15s ease, border-color .15s ease}
      .btn:disabled{opacity:.6;cursor:not-allowed}
      .btn-primary{background:var(--brand);color:#fff}
      .btn-primary:hover{background:var(--brand-600)}
      .btn-ghost{background:transparent;color:var(--brand);border-color:#e0e7ff}
      .btn-ghost:hover{background:#eef2ff}
      .btn-subtle{background:#f3f4f6;color:#111827;border-color:#e5e7eb}
      .btn-subtle:hover{background:#e5e7eb}
      .checkbox{display:flex;align-items:center;gap:10px;cursor:pointer}
      .checkbox input{width:20px;height:20px}
      .grid{display:grid;grid-template-columns:1fr;gap:10px;margin-top:16px}
      @media (min-width:640px){.grid{grid-template-columns:repeat(2,1fr)}}
      .btn-row{display:flex;gap:10px;margin-top:16px;flex-wrap:wrap}
      .btn-row.center{justify-content:center}
      .actions{margin-top:20px}
      .actions.end{display:flex;justify-content:flex-end}
      .actions.space-between{display:flex;justify-content:space-between}
      .title-row{display:flex;align-items:flex-start;justify-content:space-between;gap:12px}
      .alert{margin-top:16px;border-radius:12px;padding:12px;border:1px solid}
      .alert-title{font-weight:700}
      .alert-text{margin-top:4px}
      .alert-sub{font-size:14px;opacity:.9;margin-top:6px}
      .alert-success{background:#ecfdf5;border-color:#a7f3d0;color:#065f46}
      .alert-error{background:#fef2f2;border-color:#fecaca;color:#991b1b}
      .alert-warn{background:#fffbeb;border-color:#fde68a;color:#92400e}
      .alert-info{background:#eef2ff;border-color:#e0e7ff;color:#3730a3}
      .list{margin:10px 0 0 18px}
      .list li{margin:6px 0}
      .summary{margin-top:16px}
      .summary-list{list-style:none;padding:0;margin:8px 0 0 0;display:grid;gap:10px}
      .summary-item{border:1px solid var(--border);border-radius:12px;padding:12px}
      .summary-head{display:flex;align-items:center;justify-content:space-between}
      .summary-title{font-weight:600}
      .badge{font-size:12px;padding:4px 8px;border-radius:999px}
      .badge.ok{background:#dcfce7;color:#065f46}
      .badge.warn{background:#fff7ed;color:#b45309}
      .summary-body{font-size:14px;margin-top:8px;color:#374151}
      .site-footer{max-width:960px;margin:0 auto;padding:0 16px 28px;font-size:12px;color:#6b7280;text-align:center}
      .modal-backdrop{position:fixed;inset:0;z-index:50}
      .modal-scrim{position:absolute;inset:0;background:rgba(0,0,0,.4)}
      .modal{position:absolute;inset:0;display:flex;align-items:flex-start;justify-content:center;overflow:auto;padding:16px}
      @media (min-width:768px){.modal{align-items:center}}
      .modal .modal-header{background:#fff;border-radius:16px 16px 0 0;padding:12px 16px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
      .modal .modal-body{background:#fff;border-radius:0 0 16px 16px;padding:16px;max-width:768px;width:100%}
      .modal .modal-body p{margin:0 0 10px 0}
      @media print{ .site-header,.site-footer,.btn,.pill-row{display:none !important} .container{padding:0} .card{box-shadow:none;border:0;padding:0} }
      .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
    </style>
  </head>
  <body>
    <div id="root"></div>

    <!-- React 18 + ReactDOM from CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel Standalone compiles our JSX in the browser (fine for prototypes) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
      const { useCallback, useEffect, useMemo, useRef, useState } = React;

      const STORAGE_KEY = "ethicsInteractiveState.v2";
      const isBrowser = typeof window !== "undefined" && typeof document !== "undefined";

      const CASES = [
        { id: 1, title: "Case Study 1: Leikessa Jones", scenario: [
            `Leikessa Jones owns her own consulting business, and has several people working for her. Leikessa is currently designing a database management system for the personnel office of ToyTimeInc., a mid-sized company that makes toys. Leikessa has involved ToyTimeInc management in the design process from the start of the project. It is now time to decide about the kind and degree of security to build into the system.`,
            `Leikessa has described several options to the client. The client has decided to opt for the least secure system because the system is going to cost more than was initially planned, and the least secure option is the cheapest security option. Leikessa knows that the database includes sensitive information, such as performance evaluations, medical records, and salaries. With weak security, she fears that enterprising ToyTimeInc employees will be able to easily access this sensitive data. Furthermore, she fears that the system will be an easy target for external hackers. Leikessa feels strongly that the system should be more secure than it would be if the least secure option is selected.`,
            `Ms. Jones has tried to explain the risks to ToyTimeInc, but the CEO, the CIO, and the Director of Personnel are all convinced that the cheapest security is what they want. Should Jones refuse to build the system with the least secure option?`,
          ], correct: ["Public","Client and Employer","Product"], analysis: [
            `Why is the decision to opt for the least secure system a problem, even if the client has accepted the risks? How does this decision impact the "Public" and "Product" principles?`,
            `What are Leikessa's professional obligations in this situation, considering her knowledge of the potential risks?`,
            `What steps could Leikessa have taken earlier in the project to prevent this ethical dilemma from reaching a point of conflict?`,
          ] },
        { id: 2, title: "Case Study 2: Zara", scenario: [
            `Zara is a software engineer at a fast-growing startup developing a mobile app for mental health support. Due to tight deadlines, management imposes a grueling work schedule, requiring engineers to work nights and weekends without additional compensation.`,
            `Zara notices that the excessive workload is affecting her and her colleagues' well-being, leading to burnout and increased errors in the code. Some developers have started cutting corners, skipping critical testing phases to meet deadlines. This has resulted in multiple app crashes and inaccurate mental health assessments for users.`,
            `She raises her concerns with her manager, explaining that the current work conditions are unsustainable and could harm both employees and users. The manager dismisses her concerns, arguing that this is the norm in the startup world and that once the app gains traction, things will improve.`,
          ], correct: ["Public","Product","Profession","Self"], analysis: [
            `How do the grueling work schedule and corner-cutting violate the "Product" and "Profession" principles?`,
            `How does Zara's situation relate to the "Colleagues" and "Self" principles?`,
            `What ethical steps could Zara take if her manager continues to dismiss her concerns and the problems persist?`,
          ] },
        { id: 3, title: "Case Study 3: AI Bias", scenario: [
            `You are a software engineer working on an AI-powered recruitment tool for a major tech company. After deployment, an internal audit reveals that the algorithm disproportionately rejects female candidates for technical roles. Further investigation shows that the training data was biased toward historical hiring patterns that favored men.`,
            `Your manager suggests keeping the algorithm as is since changing it would delay product release and cost millions. He argues that the company is not explicitly discriminating—it's just a flaw in the data.`,
          ], correct: ["Public","Product","Profession"], analysis: [
            `Explain why the AI system is unethical, even if the bias was unintentional and the company is "just" using historical data. How does this decision impact the "Public" principle?`,
            `What is the ethical responsibility of the software engineer and the manager in this scenario?`,
            `How could the team have prevented this issue from occurring in the first place?`,
          ] },
      ];

      const ALL_PRINCIPLES = ["Public","Client and Employer","Product","Judgement","Management","Profession","Colleagues","Self"];

      function hasExactSet(pickedArr, correctArr){ if(!Array.isArray(pickedArr)||!Array.isArray(correctArr)) return false; const a=new Set(pickedArr); const b=new Set(correctArr); if(a.size!==b.size) return false; for(const v of a) if(!b.has(v)) return false; return true; }

      function usePersistentState(defaultValue){
        const [state, setState] = React.useState(() => {
          if(!isBrowser) return defaultValue;
          try{ const raw = window.localStorage.getItem(STORAGE_KEY); return raw ? JSON.parse(raw) : defaultValue; } catch { return defaultValue; }
        });
        React.useEffect(() => { if(!isBrowser) return; const id=setTimeout(()=>{ try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); } catch{} },150); return ()=>clearTimeout(id); }, [state]);
        return [state, setState];
      }

      function ProgressBar({step,total}){ const pct=Math.round(((step+1)/total)*100); return (
        <div className="progress-wrap" aria-label={`Progress: ${pct}%`}>
          <div className="progress"><div className="progress-bar" role="progressbar" aria-valuemin={0} aria-valuemax={100} aria-valuenow={pct} style={{width:`${pct}%`}}/></div>
          <div className="progress-text">{pct}%</div>
        </div> ); }

      const Pill = ({children}) => <span className="pill">{children}</span>;
      const Card = ({children, className=""}) => <div className={`card ${className}`}>{children}</div>;
      function Button({children,onClick,variant="primary",disabled=false,...props}){ return <button type="button" className={`btn btn-${variant}`} onClick={onClick} disabled={disabled} {...props}>{children}</button>; }
      function Checkbox({id,label,checked,onChange}){ return <label htmlFor={id} className="checkbox"><input id={id} type="checkbox" checked={checked} onChange={onChange}/><span>{label}</span></label>; }

      function Modal({ open, onClose, title, children }){
        const modalRef = React.useRef(null);
        const lastFocusRef = React.useRef(null);
        React.useEffect(()=>{
          if(!open||!isBrowser) return;
          lastFocusRef.current = document.activeElement;
          const el = modalRef.current;
          setTimeout(()=> el?.querySelector('[data-autofocus]')?.focus(), 0);
          const onKey=(e)=>{
            if(e.key==='Escape') onClose();
            if(e.key==='Tab'){
              const focusable = el.querySelectorAll('button,[href],input,select,textarea,[tabindex]:not([tabindex="-1"])');
              if(!focusable.length) return; const first=focusable[0]; const last=focusable[focusable.length-1];
              if(e.shiftKey && document.activeElement===first){ e.preventDefault(); last.focus(); }
              else if(!e.shiftKey && document.activeElement===last){ e.preventDefault(); first.focus(); }
            }
          };
          document.addEventListener('keydown', onKey);
          document.body.style.overflow='hidden';
          return ()=>{ document.removeEventListener('keydown', onKey); document.body.style.overflow=''; lastFocusRef.current && lastFocusRef.current.focus(); };
        }, [open, onClose]);
        if(!open) return null;
        return (
          <div className="modal-backdrop" role="dialog" aria-modal="true" aria-labelledby="modal-title">
            <div className="modal-scrim" onClick={onClose}></div>
            <div className="modal" ref={modalRef}>
              <div className="modal-header">
                <h3 id="modal-title">{title}</h3>
                <button className="btn btn-ghost" onClick={onClose} aria-label="Close" data-autofocus>×</button>
              </div>
              <div className="modal-body">{children}</div>
            </div>
          </div>
        );
      }

      function Feedback({ caseObj, picked, hasChecked }){
        const pickedSet = new Set(picked), correctSet = new Set(caseObj.correct);
        if(!hasChecked) return null;
        const correctCount = picked.filter(p=>correctSet.has(p)).length;
        const incorrectCount = picked.length - correctCount;
        const missing = caseObj.correct.filter(p=>!pickedSet.has(p));
        let tone='info', message='';
        if(correctCount===caseObj.correct.length && incorrectCount===0){ tone='success'; message="Great job! That's the exact set."; }
        else if(correctCount===0 && picked.length>0){ tone='error'; message='We disagree. While one could argue for some, we think none of your choices are the key principles in this scenario.'; }
        else if(missing.length>0){ tone='error'; message=`Close—you're missing ${missing.length} key principle${missing.length>1?'s':''}.`; }
        else if(incorrectCount>0){ tone='warn'; message="You've selected the right ones—but with a few extras. Consider removing any you felt unsure about."; }
        return (
          <div className={`alert alert-${tone}`} role="status" aria-live="polite">
            <div className="alert-title">Feedback</div>
            <div className="alert-text">{message}</div>
            <div className="alert-sub"><strong>Your picks:</strong> {picked.length ? picked.join(', ') : '—'}</div>
            {tone!=='success' && <div className="alert-sub"><strong>Tip:</strong> Aim for the exact set. You can always try again before continuing.</div>}
          </div>
        );
      }

      function App(){
        const [state, setState] = usePersistentState({ step:0, selections:{}, checked:{}, complete:false });
        const [isScenarioOpen, setIsScenarioOpen] = React.useState(false);
        const totalSteps = 1 + CASES.length*3 + 1;
        const currentCaseIndex = React.useMemo(()=>{ if(state.step===0) return -1; const relative=state.step-1; return Math.floor(relative/3); }, [state.step]);
        const subStep = React.useMemo(()=>{ if(state.step===0) return 'welcome'; const relative=state.step-1; const mod=relative%3; return ['scenario','principles','analysis'][mod]; }, [state.step]);
        const goto = React.useCallback((step)=> setState(s=>({...s, step})), [setState]);
        const next = React.useCallback(()=> setState(s=>{ const step=Math.min(s.step+1, totalSteps-1); return {...s, step, complete: step===totalSteps-1}; }), [setState,totalSteps]);
        const resetAll = React.useCallback(()=>{ if(isBrowser) localStorage.removeItem(STORAGE_KEY); setState({ step:0, selections:{}, checked:{}, complete:false }); }, [setState]);
        const activeCase = CASES[currentCaseIndex];
        const toggleSelection = React.useCallback((caseId, principle)=> setState(s=>{ const sel=new Set(s.selections[caseId]||[]); sel.has(principle)?sel.delete(principle):sel.add(principle); return {...s, selections:{...s.selections, [caseId]:Array.from(sel)} }; }), [setState]);
        const checkAnswers = React.useCallback((caseId)=> setState(s=>({...s, checked:{...s.checked, [caseId]:true}})), [setState]);
        const isCorrect = React.useCallback((caseId)=>{ const picked=state.selections[caseId]||[]; const correct=CASES.find(c=>c.id===caseId).correct; return hasExactSet(picked, correct); }, [state.selections]);
        React.useEffect(()=>{ if(!isBrowser) return; try{ console.assert(hasExactSet(["Public","Client and Employer","Product"], CASES[0].correct)===true); }catch(e){} }, []);
        const exportResults = React.useCallback(()=>{ const results = CASES.map(c=>({ case:c.title, selected:state.selections[c.id]||[], correct:c.correct, isCorrect:isCorrect(c.id) })); const blob=new Blob([JSON.stringify({ results, completedStep: state.step }, null, 2)],{type:'application/json'}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='ethics-interactive-results.json'; a.click(); URL.revokeObjectURL(url); }, [isCorrect, state.selections, state.step]);
        return (
          <div className="page">
            <header className="site-header">
              <div className="header-inner">
                <div className="brand">
                  <div className="brand-badge" aria-hidden></div>
                  <div>
                    <div className="brand-title">Software Engineering Ethics</div>
                    <div className="brand-sub">Interactive Learning Module</div>
                  </div>
                </div>
                <div className="header-actions">
                  <button className="btn btn-ghost" onClick={()=>window.print()}>Print</button>
                  <button className="btn btn-ghost" onClick={exportResults}>Export</button>
                  <button className="btn btn-subtle" onClick={resetAll}>Reset</button>
                </div>
              </div>
              <div className="header-progress">
                <ProgressBar step={state.step} total={totalSteps} />
              </div>
            </header>

            <main className="container">
              {subStep==='welcome' && (
                <div className="card text-center">
                  <h1 className="h1">Software Engineering Ethics Interactive</h1>
                  <p className="lead">Welcome! You'll explore three case studies. For each scenario, select all relevant principles from the <em>Software Engineering Code of Ethics and Professional Practice</em>, then review guided analysis.</p>
                  <div className="pill-row"><span className="pill">3 case studies</span><span className="pill">Self-paced</span><span className="pill">Auto-save</span></div>
                  <div className="actions"><button className="btn btn-primary" onClick={()=>goto(1)}>Begin</button></div>
                </div>
              )}

              {subStep==='scenario' && activeCase && (
                <div className="card">
                  <h2 className="h2">{activeCase.title}</h2>
                  <div className="prose">{activeCase.scenario.map((p,i)=>(<p key={i}>{p}</p>))}</div>
                  <div className="actions end"><button className="btn btn-primary" onClick={next}>Continue</button></div>
                </div>
              )}

              {subStep==='principles' && activeCase && (
                <div className="card">
                  <h2 className="h2">{activeCase.title} – Principles</h2>
                  <p className="muted">Select all principles that apply. You must match the exact set to proceed.</p>
                  <fieldset className="choices">
                    <legend className="sr-only">Select all principles that apply</legend>
                    <div className="grid">{ALL_PRINCIPLES.map((p)=>(
                      <label key={p} htmlFor={`c${activeCase.id}-${p}`} className="checkbox">
                        <input id={`c${activeCase.id}-${p}`} type="checkbox" checked={(state.selections[activeCase.id]||[]).includes(p)} onChange={()=>toggleSelection(activeCase.id,p)} />
                        <span>{p}</span>
                      </label>
                    ))}</div>
                  </fieldset>
                  <div className="btn-row">
                    <button className="btn btn-primary" onClick={()=>checkAnswers(activeCase.id)}>Check Answers</button>
                    <button className="btn btn-ghost" onClick={()=>setState(s=>({...s, selections:{...s.selections, [activeCase.id]: activeCase.correct}}))} aria-label="Fill with correct answers">Reveal Set</button>
                  </div>
                  <Feedback caseObj={activeCase} picked={state.selections[activeCase.id]||[]} hasChecked={!!state.checked[activeCase.id]} />
                  <div className="actions end"><button className="btn btn-primary" onClick={next} disabled={!isCorrect(activeCase.id)} aria-disabled={!isCorrect(activeCase.id)}>Continue</button></div>
                </div>
              )}

              {subStep==='analysis' && activeCase && (
                <>
                  <div className="card">
                    <div className="title-row">
                      <h2 className="h2">{activeCase.title} – Analysis</h2>
                      <button className="btn btn-ghost" onClick={()=>setIsScenarioOpen(true)} aria-haspopup="dialog">View Scenario</button>
                    </div>
                    <p className="muted">Consider these prompts for discussion or reflection:</p>
                    <ol className="list">{activeCase.analysis.map((q,i)=>(<li key={i}>{q}</li>))}</ol>
                    <div className="actions space-between">
                      <button className="btn btn-ghost" onClick={()=>goto(1 + currentCaseIndex * 3 + 1)}>Back to Principles</button>
                      <button className="btn btn-primary" onClick={next}>Continue</button>
                    </div>
                  </div>
                  <Modal open={isScenarioOpen} onClose={()=>setIsScenarioOpen(false)} title={`${activeCase.title} – Scenario`}>
                    <div className="prose">{activeCase.scenario.map((p,i)=>(<p key={i}>{p}</p>))}</div>
                  </Modal>
                </>
              )}

              {state.complete && subStep!=='welcome' && (
                <div className="card text-center">
                  <h2 className="h2">Thanks for participating!</h2>
                  <p className="muted">You can export your selections or print this page for records.</p>
                  <div className="btn-row center">
                    <button className="btn btn-ghost" onClick={exportResults}>Export Results</button>
                    <button className="btn btn-ghost" onClick={()=>window.print()}>Print</button>
                    <button className="btn btn-subtle" onClick={resetAll}>Restart</button>
                  </div>
                  <div className="summary">
                    <h3 className="h3">Summary</h3>
                    <ul className="summary-list">{CASES.map((c)=>(
                      <li key={c.id} className="summary-item">
                        <div className="summary-head">
                          <span className="summary-title">{c.title}</span>
                          <span className={`badge ${ ( (state.selections[c.id]||[]).length && hasExactSet(state.selections[c.id], c.correct) ) ? 'ok':'warn'}`}>{ ((state.selections[c.id]||[]).length && hasExactSet(state.selections[c.id], c.correct)) ? 'Correct set' : 'Has differences' }</span>
                        </div>
                        <div className="summary-body"><div><strong>Your picks:</strong> {(state.selections[c.id]||[]).join(', ') || '—'}</div><div><strong>Expected:</strong> {c.correct.join(', ')}</div></div>
                      </li>
                    ))}</ul>
                  </div>
                </div>
              )}
            </main>

            <footer className="site-footer"><div>Built with ❤️ — Accessible, responsive, and printable.</div></footer>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>
